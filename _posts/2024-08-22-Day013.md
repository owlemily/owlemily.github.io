---
title: <Day013> Naver Boostcamp AI Tech
date: 2024-08-22
layout: post
tags: [Naver Boostcamp, daily report]
---
강의진도: 5강, 6강, 6강 실습, 과제 기본4
### 회고
- 마스터클래스 안수빈 마스터님 
	- 인상깊은 내용
- 멀티모달이라는 단어를 알게 되었다.
- 정규표현식에 대해서 정확하게 알게 되었다. 역슬래시를 사용한다는 것을 알게 되었다.

## 새롭게 배운 내용

**시계열데이터**
- 하락, 단조성장, 급진성장 등 시간에 따른 주기적인 추세를 볼 수 있다.
- 계절성(seasonality) vs 주기(cycle)
	- 주기: 고정된 빈도는 아니고 형태적으로 유사한 패턴
		ex) 경제적인 성장, 반복으로 생기는 데이터의 변화
		같은 기간이 아니여서 주기라고 말할 수 있다.
	- 계절성: 주말, 겨울 -> 특정 요일이나 계절에 영향을 받는 것.
- 노이즈: 측정오류, 내부변동성 -> 어떤 것도 완벽하게 예측할 순 없기 때문에 -> 불규칙적인 데이터

**성분분석**
- 규칙성데이터와 불규칙데이터로 나눠서 시계열을 분석하는 방법을 말한다.
- 가법모델(additive model): 추세+계절성+주기+노이즈
	-> 시간에 따라 변동폭이 일정하면 사용한다.
- 승법모델(multiplicative model): 추세 * 계절성 * 주기 + 노이즈 -> 시간에 따라 변동폭이 커지면 사용한다.
- 연속적 시계열에서는 유의미하지만 서로 다른 시계열 부근에 적용하는 것은 문제가 있다.
	- 시간에 따라 통계적 특성이 변하기 때문이다!

**정상성 vs 비정상성**
- 정상성(stationarity) : 시간에 통계적 특성이 영향받지 않고 독립적
- 비정상성(non-stationarity): 시간과 통계적 특성이 종속적
	- ==비정상성을 제거 = 시간적 특성을 제거==하고 통계모델(ex. ARIMA)에 사용해야한다.
		- 차분(Differencing): 이웃된 두 값이나 계절성 주기에 따른 두값의 차이를 구해서 차분
		- 2번 차분을 할 수도 있다.
	- 로그 연산
		- 값의 순서를 바꾸지 않고 정상성을 갖도록 만드는 방법
		- 증가추세, 감소추세 -> 없앨 수 있다. 데이터가 급진적으로 줄게 만들 수 있기 때문에

**시계열 데이터 전처리**
-> 시각화에 대한 전처리, 모델에 대한 전처리
- 차분
- 평활(Smoothing)
	- 데이터의 노이즈를 제거해서 추세나 계절성 파악에 도움을 준다. -> 시각화 개선 효과가 있다.
	- Loss function시각화했을 때 노이즈 줄일때 사용
	- ==방법1)== 구간별로 통계(평균)를 구하는 방법 (데이터 줄어듦) 
	- ==방법2)== 이동평균(Moving Average): 데이터의 개수를 유지하면서 사용. 일정구간(window_size)을 한칸씩 이동하면서 평균을 내는 것. -> 값들의 이상치에 영향 받기 쉬움. 다양한 window_size로 데이터를 봐야한다. 구간길이마다 다르게 시각화가 보이기 때문.
	
	-> 값들의 이상치에 대한 영향을 적게 미치게 하기 위해서
	- ==방법3)== 가중이동평균(Weighted Moving Average, WMA) 
	- ==방법4)== 지수이동평균(Exponenetial Moving Average, EMA) : 최신값에 대한 반영을 하기 위해 사용. 지난 지수이동평균과 현재값에 대해 비율을 둬서 계산.
---
**이미지 데이터**
- 문제정의 -> 도메인에 대한 지식 습득 -> EDA진행
- 제일 중요한 것은 도메인 지식!
- 그 외에 봐야할 것? 
	- Target 중심으로 분포 위주의 비교(정형데이터처럼)
		- 남자사진 1, 여자사진 10 -> 불균등 -> 이미지 증강, 외부에서 더 찾아오기 
	- Input 데이터 중심으로 이미지 데이터 개별 비교 
	- Process 중심으로 전처리-모델-결과해석의 반복과정
- Applied ML/ Human-Centered AI 와 같은 학회 논문은 데이터를 어떻게 만드느냐도 중요
- 데이터를 수집하는 프로세스를 연습하는 것도 좋은 방법이다.
	- 2020년부터는 데이터를 수집하는 거 자체로도 논문이 많이 나왔다.

**이미지 저장방식**
- RGB - 컴퓨터 그래픽에 활용
- HSV - 인간이 색을 보는 방식과 유사-> 색상(Hue), 채도(Saturation), 명도(Value)
- CMY(K): RGB 보색으로 인쇄에 용이
- YCbCr: 밝기/ 파랑에 대한 색차/ 빨강에 대한 색차로 구분 -> 디지털 영상에 용이

**이미지 데이터 포맷**
- JPEG : YCbCr에서 양자화를 통해 일부가 손실된다. 사람의 색 인지가 밝기에 대해 더 명확하다는  점을 활용해서 Y정보를 저 많이 갖고 있는 데이터에서 일부 손실 압축하는 방식
	-> 채널이 3개
- PNG: 채널이 4개
- WepP: 위의 두 방법을 포함하는 구글이 만든 이미지 포맷 -> 채널이 3개인지 4개인지를 확인해야함
- SVG: 벡터이미지를 통한 저장방식, 크기와 관계x 
- HEIC, AVIF

**이미지 데이터 전처리**
- 데이터의 노이즈를 제거하여 퀄리티를 향상한다.
- 데이터 양 증대 -> 유사한 데이터를 여러 개 만들어서 데이터를 증강
- 이미지데이터를 확인하는 검증 -> 시각화를 통한 확인

**이미지 데이터 라이브러리**
어떤 background, 어떤 backbone을 사용하느냐에 따라 차이가 있다. 대부분의 저장방식은 유사.
- OpenCV -> 오래됐고, 사용자체는 복잡하지만 다양한 기능이 있고, C++로 backbone이 이루어져있어서 효율적인 처리가 가능하다.
- PIL(Python Image Library)
- scikit-image
- albumentation : 이미지 전처리할 때 많이 사용한다. 데이터 증강에 활용
- torchvision: torch 기반 이미지 처리
- SciPy
---
**텍스트 데이터**
주제뽑기, 예측하기... 다양한 것들을 할 수 있다. 
까다롭다!
언어는 구조에 따라 의미가 변경될 수 있다.
영어, 한글 혼재? 또다르고
문법예외고있고 
아니근데, -> 필요없지만 어디들어가도 다 괜찮은 단어
맞춤법의 오차
방언, 신조어
...
- 멀티모달: 이미지, 오디오, 비디오 등 다양한 유형의 데이터를 함께 고려하여 서로의 관계성을 학습, 처리하는 인공지능. 
	- LMM(Large Multimodal Model)
	- 음성-텍스트: 생성 및 인식
	- 이미지-텍스트: 이미지 설명, 텍스트쿼리, 검색

**정규표현식**
- 검색, 유효성 검사에 사용한다. = 필터링 과정
- 이메일, 학번, 주소와 같은 일정한 패턴을 가진 텍스트
- [a-zA-Z0-9]+ : 알파벳 소문자, 대문자, 숫자로 이루어져있다. +표시는 1글자 이상의 표현이라는 뜻이다.
- 반드시 포함되어야하는 글자는 그냥 @이런식으로 써주면 된다.
- [a-zA-Z0-9]{2, }: 2글자 이상 쓸 수 있다는 뜻
- 정규표현식에서 .은 알파벳, 숫자, 특수문자와 같은 모든 단일문자라는 뜻 -> 즉 알파벳, 숫자, 특수문자 어떤 문자든 한글자와 매칭될 수 있다.
- 이메일 정규표현식에서 .이라는 기호 자체를 표현할 때 -> \. 으로 역슬래시를 써주면 된다.
- **`\d{3,4}`** : d는 숫자 digit을 의미한다. 숫자 0-9까지가 3번~4번 반복된다는 의미이다.

**이미지 데이터 실습**
- 이미지 데이터를 가져왔을 때 이것이 우리가 아는 3차원 RGB가 아닐 수도 있기 때문에 shape을 확인해보기. 차원을 확인해보기.
```python
# URL로부터 이미지 데이터를 가져옴
response = requests.get(image_url)

#PIL.Image객체로 변환
#response.content를 통해 2진수 데이터로 변환
test_image = Image.open(BytesIO(response.content)) 
#BytesIO는 파일을 저장하지 않고 메모리에서 직접 데이터 작업을 할 수 있게 하는 도구
#BytesIO를 통해 메모리에서 파일처럼 읽을 수 있도록 변환한다.

#PIL.Image객체를 numpy 배열로 변환
test_image_np = np.array(test_image)

print(test_image_np.shape)
```
- 이미지를 보는 가장 쉬운 방법은 
```python
plt.imshow(test_image)
```
- visualization.plot_image_gallery() 함수
```python
keras_cv.visualization.plot_image_gallery(
        x_train,
        value_range=(0, 255),
        rows=2,
        cols=3,
    )
```
데이터를 주고, row, column을 주어서 nxm으로 데이터를 한번에 볼 수 있다.
matplotlib의 2,3이런식으로 주지 않아도 알아서 데이터를 확인할 수 있다. EDA할 때 유용하다.
- keras_cs는 문서가 잘 작성되어있는 건 아니여서 아직 개선점은 많다고 생각한다.
	- torchvision도 향후에는 이런 것들이 추가될 수 있지 않을까
---
- 대회에서 가장 많이 사용하는 library는 `Albumentations` 인 것 같다.
	- 요즘엔 torchvision도 많이 발전해서 많이 쓰고 있음
	- Albumentation은 torch와 연결도 잘 되어있고, 실제로 데이터 대회에서 사용하는 다양한 것들을 포함하고 있기 때문에 추천!
---
**이미지의 전처리가 가지는 의미**
- 이미지가 가지고 있는 메타 데이터를 어떤 식으로 볼 것이냐.
- 이 메타데이터와 이미지를 어떻게 연관지을 것이냐
- 이미지 데이터에 대해서 어떻게 관찰할 것이냐. 
- Crop, 밀도 맞추기, 많은 가정을 넣는 것이 중요하다. 
### 선형대수학
- Diagonalization
    
    - square matrix에서 따진다.
    - 주어진 matrix를 대각행렬로 만든다.
    - 행렬에서 대각선에만 수가 있고 나머지는 모두 0인 matrix
    - 행렬을 → diagonal matrix로 변환해보자!
    
    $$ D = V^-1 A V $$
    
    - A라는 input을 V^-1과 V를 곱해서 대각행렬로 마드다.
    - V는 invertable한 square matrix
    - 이때의 A를 diagonalizable하다고 말한다.
    - A가 nxn이면 V도 nxn, D도 nxn matrix이다.
      
### 피어세션
- 과제4리뷰(과제3하고 순서가 바뀐거같아서 내일 과제3리뷰)
- 선형대수학발표
- 강의 리뷰5-1 시계열데이터
    - 강의가 생각보다 간단해서 좀 아쉬웠다.

